2022-02-13 14:16:17 [MainThread] INFO [StudyEvaluater] - use cpu
2022-02-13 14:16:17 [MainThread] INFO [StudyEvaluater] - use device cpu
2022-02-13 14:16:17 [MainThread] INFO [StudyEvaluater] - gt_file_or_folder: /media/ubuntu/Seagate Expansion Drive/IACTA/CellPress1338/external/A/ane_seg
2022-02-13 14:16:17 [MainThread] INFO [StudyEvaluater] - pred_file_or_folder: /home/ubuntu/codes/MyMedicalZoo/output/ExA/pred
2022-02-13 14:16:17 [MainThread] INFO [StudyEvaluater] - mask or probability distribution: mask
2022-02-13 14:16:17 [MainThread] INFO [StudyEvaluater] - Begin to scan gt_folder_or_file /media/ubuntu/Seagate Expansion Drive/IACTA/CellPress1338/external/A/ane_seg...
2022-02-13 14:16:17 [MainThread] INFO [StudyEvaluater] - Begin to scan pred_folder_or_file /home/ubuntu/codes/MyMedicalZoo/output/ExA/pred...
2022-02-13 14:16:17 [MainThread] INFO [StudyEvaluater] - instance number: 69. start evaluating...
2022-02-13 14:36:37 [MainThread] INFO [StudyEvaluater] - (1 in 69) ExtA0001:	ap: 0.5224	auc: 0.6119	precision: 0.9328	recall: 0.2238	sensitivity: 0.2238	specificity: 1.0000	dsc: 0.3610	hd95: 3.9051	tp: 250	fp: 18	fn: 867	tn: 90998805	per_target_precision: 1.0000	per_target_recall: 1.0000	per_target_tp: 1	per_target_fp: 0	per_target_fn: 0
2022-02-13 14:56:40 [MainThread] INFO [StudyEvaluater] - (2 in 69) ExtA0002:	ap: 0.0000	auc: 0.5000	precision: 0.0000	recall: 0.0000	sensitivity: 0.0000	specificity: 1.0000	dsc: 0.0000	hd95: 148.8425	tp: 0	fp: 3105	fn: 2238	tn: 87288609	per_target_precision: 0.0000	per_target_recall: 0.0000	per_target_tp: 0	per_target_fp: 1	per_target_fn: 1
2022-02-13 15:18:05 [MainThread] INFO [StudyEvaluater] - (3 in 69) ExtA0003:	ap: 0.2049	auc: 0.8495	precision: 0.0602	recall: 0.6991	sensitivity: 0.6991	specificity: 0.9999	dsc: 0.1109	hd95: 141.1847	tp: 567	fp: 8844	fn: 244	tn: 94362185	per_target_precision: 0.1667	per_target_recall: 1.0000	per_target_tp: 1	per_target_fp: 5	per_target_fn: 0
2022-02-13 15:37:53 [MainThread] INFO [StudyEvaluater] - (4 in 69) ExtA0004:	ap: 0.0000	auc: 0.5000	precision: 0.0000	recall: 0.0000	sensitivity: 0.0000	specificity: 1.0000	dsc: 0.0000	hd95: 33.0634	tp: 0	fp: 53	fn: 4954	tn: 87288945	per_target_precision: 0.0000	per_target_recall: 0.0000	per_target_tp: 0	per_target_fp: 2	per_target_fn: 1
2022-02-13 15:54:58 [MainThread] INFO [StudyEvaluater] - (5 in 69) ExtA0005:	ap: 0.3750	auc: 0.7500	precision: 0.0000	recall: 0.5000	sensitivity: 0.5000	specificity: 1.0000	dsc: 0.0000	hd95: 1.0000	tp: 0	fp: 89	fn: 0	tn: 77834855	per_target_precision: 0.0000	per_target_recall: 0.5000	per_target_tp: 0	per_target_fp: 1	per_target_fn: 0
2022-02-13 16:31:48 [MainThread] INFO [StudyEvaluater] - (6 in 69) ExtA0006:	ap: 0.0000	auc: 0.5000	precision: 0.0000	recall: 0.0000	sensitivity: 0.0000	specificity: 1.0000	dsc: 0.0000	hd95: 257.1406	tp: 0	fp: 717	fn: 1274	tn: 170235934	per_target_precision: 0.0000	per_target_recall: 0.0000	per_target_tp: 0	per_target_fp: 6	per_target_fn: 1
2022-02-13 16:52:51 [MainThread] INFO [StudyEvaluater] - (7 in 69) ExtA0007:	ap: 0.3750	auc: 0.7500	precision: 0.0000	recall: 0.5000	sensitivity: 0.5000	specificity: 1.0000	dsc: 0.0000	hd95: 1.0000	tp: 0	fp: 101	fn: 0	tn: 97549615	per_target_precision: 0.0000	per_target_recall: 0.5000	per_target_tp: 0	per_target_fp: 2	per_target_fn: 0
2022-02-13 17:25:29 [MainThread] INFO [StudyEvaluater] - (8 in 69) ExtA0008:	ap: 0.3750	auc: 0.7500	precision: 0.0000	recall: 0.5000	sensitivity: 0.5000	specificity: 1.0000	dsc: 0.0000	hd95: 1.0000	tp: 0	fp: 176	fn: 0	tn: 154542649	per_target_precision: 0.0000	per_target_recall: 0.5000	per_target_tp: 0	per_target_fp: 3	per_target_fn: 0
2022-02-13 17:45:24 [MainThread] INFO [StudyEvaluater] - (9 in 69) ExtA0010:	ap: 0.5171	auc: 0.7087	precision: 0.8254	recall: 0.4175	sensitivity: 0.4175	specificity: 1.0000	dsc: 0.5545	hd95: 72.8121	tp: 1933	fp: 409	fn: 2697	tn: 128707665	per_target_precision: 0.1429	per_target_recall: 1.0000	per_target_tp: 1	per_target_fp: 6	per_target_fn: 0
2022-02-13 18:39:15 [MainThread] INFO [StudyEvaluater] - (10 in 69) ExtA0011:	ap: 0.0352	auc: 0.5439	precision: 0.0264	recall: 0.0878	sensitivity: 0.0878	specificity: 1.0000	dsc: 0.0406	hd95: 248.1496	tp: 216	fp: 7959	fn: 2243	tn: 252037282	per_target_precision: 0.1667	per_target_recall: 1.0000	per_target_tp: 1	per_target_fp: 5	per_target_fn: 0
2022-02-13 18:58:26 [MainThread] INFO [StudyEvaluater] - (11 in 69) ExtA0012:	ap: 0.0000	auc: 0.5000	precision: 0.0000	recall: 0.0000	sensitivity: 0.0000	specificity: 1.0000	dsc: 0.0000	hd95: 82.0392	tp: 0	fp: 14	fn: 544	tn: 121372114	per_target_precision: 0.5000	per_target_recall: 0.0000	per_target_tp: 0	per_target_fp: 0	per_target_fn: 1
2022-02-13 19:27:28 [MainThread] INFO [StudyEvaluater] - (12 in 69) ExtA0013:	ap: 0.3750	auc: 0.7500	precision: 0.0000	recall: 0.5000	sensitivity: 0.5000	specificity: 1.0000	dsc: 0.0000	hd95: 1.0000	tp: 0	fp: 105	fn: 0	tn: 142634159	per_target_precision: 0.0000	per_target_recall: 0.5000	per_target_tp: 0	per_target_fp: 1	per_target_fn: 0
2022-02-13 19:42:17 [MainThread] INFO [StudyEvaluater] - (13 in 69) ExtA0014:	ap: 0.5269	auc: 0.7594	precision: 0.7945	recall: 0.5188	sensitivity: 0.5188	specificity: 1.0000	dsc: 0.6277	hd95: 13.8834	tp: 317	fp: 82	fn: 294	tn: 66059595	per_target_precision: 0.3333	per_target_recall: 1.0000	per_target_tp: 1	per_target_fp: 2	per_target_fn: 0
2022-02-13 20:01:40 [MainThread] INFO [StudyEvaluater] - (14 in 69) ExtA0015:	ap: 0.5600	auc: 0.6818	precision: 0.9383	recall: 0.3636	sensitivity: 0.3636	specificity: 1.0000	dsc: 0.5241	hd95: 2.1562	tp: 152	fp: 10	fn: 266	tn: 87293524	per_target_precision: 1.0000	per_target_recall: 1.0000	per_target_tp: 1	per_target_fp: 0	per_target_fn: 0
2022-02-13 20:20:46 [MainThread] INFO [StudyEvaluater] - (15 in 69) ExtA0016:	ap: 0.6447	auc: 0.8972	precision: 0.8921	recall: 0.7945	sensitivity: 0.7945	specificity: 1.0000	dsc: 0.8405	hd95: 47.6626	tp: 8769	fp: 1061	fn: 2268	tn: 87281854	per_target_precision: 0.3333	per_target_recall: 1.0000	per_target_tp: 1	per_target_fp: 2	per_target_fn: 0
2022-02-13 20:48:20 [MainThread] INFO [StudyEvaluater] - (16 in 69) ExtA0017:	ap: 0.3748	auc: 0.7409	precision: 0.5087	recall: 0.4818	sensitivity: 0.4818	specificity: 1.0000	dsc: 0.4949	hd95: 79.0557	tp: 583	fp: 563	fn: 627	tn: 128416680	per_target_precision: 0.2500	per_target_recall: 1.0000	per_target_tp: 1	per_target_fp: 3	per_target_fn: 0
2022-02-13 21:18:49 [MainThread] INFO [StudyEvaluater] - (17 in 69) ExtA0018:	ap: 0.3750	auc: 0.7500	precision: 0.0000	recall: 0.5000	sensitivity: 0.5000	specificity: 1.0000	dsc: 0.0000	hd95: 1.0000	tp: 0	fp: 51	fn: 0	tn: 149382477	per_target_precision: 0.0000	per_target_recall: 0.5000	per_target_tp: 0	per_target_fp: 1	per_target_fn: 0
2022-02-13 21:48:27 [MainThread] INFO [StudyEvaluater] - (18 in 69) ExtA0019:	ap: 0.0062	auc: 0.5022	precision: 0.0103	recall: 0.0043	sensitivity: 0.0043	specificity: 1.0000	dsc: 0.0061	hd95: 4.3012	tp: 3	fp: 288	fn: 690	tn: 136822392	per_target_precision: 1.0000	per_target_recall: 1.0000	per_target_tp: 1	per_target_fp: 0	per_target_fn: 0
2022-02-13 22:20:05 [MainThread] INFO [StudyEvaluater] - (19 in 69) ExtA0020:	ap: 0.3750	auc: 0.7500	precision: 0.0000	recall: 0.5000	sensitivity: 0.5000	specificity: 1.0000	dsc: 0.0000	hd95: 1.0000	tp: 0	fp: 42	fn: 0	tn: 153836454	per_target_precision: 0.0000	per_target_recall: 0.5000	per_target_tp: 0	per_target_fp: 1	per_target_fn: 0
2022-02-13 22:56:45 [MainThread] INFO [StudyEvaluater] - (20 in 69) ExtA0021:	ap: 0.5736	auc: 0.8354	precision: 0.8118	recall: 0.6707	sensitivity: 0.6707	specificity: 1.0000	dsc: 0.7346	hd95: 202.8213	tp: 1868	fp: 433	fn: 917	tn: 171362782	per_target_precision: 0.2000	per_target_recall: 1.0000	per_target_tp: 1	per_target_fp: 4	per_target_fn: 0
2022-02-13 23:15:53 [MainThread] INFO [StudyEvaluater] - (21 in 69) ExtA0022:	ap: 0.4829	auc: 0.7510	precision: 0.7148	recall: 0.5020	sensitivity: 0.5020	specificity: 1.0000	dsc: 0.5898	hd95: 17.5325	tp: 4055	fp: 1618	fn: 4023	tn: 87284256	per_target_precision: 0.5000	per_target_recall: 1.0000	per_target_tp: 1	per_target_fp: 1	per_target_fn: 0
2022-02-13 23:39:33 [MainThread] INFO [StudyEvaluater] - (22 in 69) ExtA0023:	ap: 0.3750	auc: 0.7500	precision: 0.0000	recall: 0.5000	sensitivity: 0.5000	specificity: 1.0000	dsc: 0.0000	hd95: 1.0000	tp: 0	fp: 5	fn: 0	tn: 114984179	per_target_precision: 0.5000	per_target_recall: 0.5000	per_target_tp: 0	per_target_fp: 0	per_target_fn: 0
2022-02-13 23:58:34 [MainThread] INFO [StudyEvaluater] - (23 in 69) ExtA0024:	ap: 0.2173	auc: 0.7776	precision: 0.1569	recall: 0.5553	sensitivity: 0.5553	specificity: 1.0000	dsc: 0.2447	hd95: 179.9621	tp: 808	fp: 4341	fn: 647	tn: 87288156	per_target_precision: 0.5000	per_target_recall: 1.0000	per_target_tp: 1	per_target_fp: 1	per_target_fn: 0
2022-02-14 00:39:31 [MainThread] INFO [StudyEvaluater] - (24 in 69) ExtA0025:	ap: 0.6559	auc: 0.8160	precision: 0.9958	recall: 0.6320	sensitivity: 0.6320	specificity: 1.0000	dsc: 0.7732	hd95: 2.0616	tp: 2600	fp: 11	fn: 1514	tn: 196604259	per_target_precision: 1.0000	per_target_recall: 1.0000	per_target_tp: 1	per_target_fp: 0	per_target_fn: 0
2022-02-14 01:01:13 [MainThread] INFO [StudyEvaluater] - (25 in 69) ExtA0026:	ap: 0.1391	auc: 0.5699	precision: 0.2084	recall: 0.1397	sensitivity: 0.1397	specificity: 1.0000	dsc: 0.1673	hd95: 76.9347	tp: 159	fp: 604	fn: 979	tn: 100364791	per_target_precision: 0.2500	per_target_recall: 1.0000	per_target_tp: 1	per_target_fp: 3	per_target_fn: 0
2022-02-14 01:18:07 [MainThread] INFO [StudyEvaluater] - (26 in 69) ExtA0027:	ap: 0.5460	auc: 0.7967	precision: 0.7954	recall: 0.5935	sensitivity: 0.5935	specificity: 1.0000	dsc: 0.6797	hd95: 22.0737	tp: 2981	fp: 767	fn: 2042	tn: 77326690	per_target_precision: 0.2000	per_target_recall: 1.0000	per_target_tp: 1	per_target_fp: 4	per_target_fn: 0
2022-02-14 01:38:20 [MainThread] INFO [StudyEvaluater] - (27 in 69) ExtA0028:	ap: 0.3750	auc: 0.7500	precision: 0.0000	recall: 0.5000	sensitivity: 0.5000	specificity: 1.0000	dsc: 0.0000	hd95: 1.0000	tp: 0	fp: 222	fn: 0	tn: 97795938	per_target_precision: 0.0000	per_target_recall: 0.5000	per_target_tp: 0	per_target_fp: 1	per_target_fn: 0
2022-02-14 02:00:14 [MainThread] INFO [StudyEvaluater] - (28 in 69) ExtA0029:	ap: 0.5960	auc: 0.9051	precision: 0.7868	recall: 0.8102	sensitivity: 0.8102	specificity: 1.0000	dsc: 0.7984	hd95: 1.4142	tp: 871	fp: 236	fn: 204	tn: 109478311	per_target_precision: 0.3333	per_target_recall: 1.0000	per_target_tp: 1	per_target_fp: 2	per_target_fn: 0
2022-02-14 02:18:58 [MainThread] INFO [StudyEvaluater] - (29 in 69) ExtA0030:	ap: 0.4700	auc: 0.7130	precision: 0.7270	recall: 0.4260	sensitivity: 0.4260	specificity: 1.0000	dsc: 0.5372	hd95: 105.7608	tp: 5678	fp: 2132	fn: 7652	tn: 118735770	per_target_precision: 0.1429	per_target_recall: 1.0000	per_target_tp: 1	per_target_fp: 6	per_target_fn: 0
2022-02-14 02:52:29 [MainThread] INFO [StudyEvaluater] - (30 in 69) ExtA0031:	ap: 0.0914	auc: 0.6647	precision: 0.0181	recall: 0.3295	sensitivity: 0.3295	specificity: 1.0000	dsc: 0.0342	hd95: 212.3029	tp: 114	fp: 6198	fn: 232	tn: 159455168	per_target_precision: 0.1000	per_target_recall: 1.0000	per_target_tp: 1	per_target_fp: 9	per_target_fn: 0
2022-02-14 02:52:36 [MainThread] ERROR [StudyEvaluater] - The size of tensor a (98234400) must match the size of tensor b (90656544) at non-singleton dimension 0
Traceback (most recent call last):
  File "evaluate_per_case.py", line 144, in <module>
    study_evaluate(config, args.gt_file_or_folder, args.pred_file_or_folder, logger, devices, pred_type)
  File "evaluate_per_case.py", line 102, in study_evaluate
    current_metrics[key] = metric_fn(pred_img[:, :, :depth // 2], gt_img[:, :depth // 2])
  File "/home/ubuntu/codes/GLIA-Net/utils/metrics.py", line 527, in __call__
    _, tp, fp, fn, _ = cm(y_pred, y_true, update=self.update, callback_fn=self.callback_fn)
  File "/home/ubuntu/codes/GLIA-Net/utils/metrics.py", line 119, in __call__
    cm[i, j] += torch.sum((y_true_flag & y_pred_flag).type(torch.int64))
RuntimeError: The size of tensor a (98234400) must match the size of tensor b (90656544) at non-singleton dimension 0
